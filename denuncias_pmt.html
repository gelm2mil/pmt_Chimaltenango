<div class="modulo fade-in">

    <h2 style="color:#00ff66; text-shadow:0 0 12px #00ff66; margin-bottom:10px;">
        Nueva denuncia
    </h2>

    <!-- FORMULARIO ENVÍA CORREO -->
    <form id="formCorreo"
        action="https://formsubmit.co/nerox2mil@proton.me"
        method="POST"
        enctype="multipart/form-data">

        <input type="hidden" name="_subject" value="Nueva denuncia PMT Chimaltenango">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_next" value="https://gelm2mil.github.io/pmt_Chimaltenango/">

        <div style="display:flex; gap:15px;">
            <div style="flex:1;">
                <label>Fecha</label>
                <input type="text" name="fecha" placeholder="dd/mm/aaaa" required>
            </div>
            <div style="flex:1;">
                <label>Hora</label>
                <input type="text" name="hora" placeholder="--:--" required>
            </div>
        </div>

        <label>Placa / DPI / Motor</label>
        <input name="placa" required placeholder="Placa vehículo, DPI o motor">

        <div style="display:flex; gap:15px;">
            <div style="flex:1;">
                <label>Tipo de denuncia</label>
                <select name="tipo">
                    <option>Transporte ilegal</option>
                    <option>Mal servicio</option>
                    <option>Exceso pasajero</option>
                    <option>Irrespeto PMT</option>
                    <option>Otros</option>
                </select>
            </div>

            <div style="flex:1;">
                <label>Estado</label>
                <select name="estado">
                    <option>Pendiente</option>
                    <option>En investigación</option>
                    <option>Finalizado</option>
                </select>
            </div>
        </div>

        <label>Lugar</label>
        <input name="lugar" placeholder="Sector, ruta o referencia">

        <label>Descripción del hecho</label>
        <textarea name="descripcion"></textarea>

        <label>Observaciones internas (uso PMT)</label>
        <textarea name="interno"></textarea>

        <label>Imagen / evidencia (opcional)</label>
        <input type="file" name="imagen" accept="image/*">

        <button class="btn-send" type="submit"
            style="margin-top:15px; background:#ff00ff; padding:10px 20px;
            border-radius:10px; border:none; cursor:pointer; color:white;
            font-weight:bold; box-shadow:0 0 12px #ff00ff;">
            ENVIAR DENUNCIA
        </button>
    </form>

    <br>

    <!-- BOTÓN QUE ENVÍA A BACKEND PHP -->
    <button onclick="enviarPHP()" 
        style="background:#00eaff; padding:10px 20px; border-radius:10px; 
        border:none; cursor:pointer; color:black; font-weight:bold; 
        box-shadow:0 0 12px #00eaff;">
        AGREGAR DENUNCIA (PMT)
    </button>

</div>

<script>
function enviarPHP() {

    const datos = new FormData();
    datos.append("fecha", document.querySelector("[name='fecha']").value);
    datos.append("hora", document.querySelector("[name='hora']").value);
    datos.append("placa", document.querySelector("[name='placa']").value);
    datos.append("tipo", document.querySelector("[name='tipo']").value);
    datos.append("estado", document.querySelector("[name='estado']").value);
    datos.append("lugar", document.querySelector("[name='lugar']").value);
    datos.append("descripcion", document.querySelector("[name='descripcion']").value);
    datos.append("interno", document.querySelector("[name='interno']").value);

    let img = document.querySelector("[name='imagen']").files[0];
    if (img) datos.append("foto", img);

    fetch("https://gelmhistoria.webcindario.com/guardar.php", {
        method: "POST",
        body: datos
    })
    .then(r => r.text())
    .then(t => {
        alert("Respuesta del servidor: " + t);
    });
}
</script>
